define("service/commonErrors",["require","exports","module"],function(e,t){"use strict";t[100001]="数据库连接错误",t[100002]="数据库查询错误",t[100003]="请求参数错误";var n=function(e){}}),define("service/ajax",["require","exports","module","./commonErrors"],function(e,t){var n=e("./commonErrors");t.post=function(e,t,r){return t=t||{},r=r||{},$.ajax({url:window.rootBase+e,data:JSON.stringify(t),method:"POST",type:"POST",dataType:"json",contentType:"application/json;charset=UTF-8",async:r.sync?!1:!0,timeout:2e4,beforeSend:r.beforeSend||function(){var e=(new Date).getTime();r._time=e,r.holder&&r.holder.append('<div class="data-loading data-loading-'+e+'">').addClass("data-loading-relative")}}).pipe(function(e){r.holder&&r.holder.removeClass("data-loading-relative").find(".data-loading-"+r._time).remove();if(e.status===200)return e;if(e.status!==302){var t=$.Deferred();return n[e.status]?t.reject(e):t.reject(e),t.promise()}window.location.href=window.rootBase+"/login"})},t.jsonp=function(e,t,r){return $.ajax({url:e,data:JSON.stringify(t),dataType:"jsonp",timeout:r,scriptCharset:"UTF-8"}).pipe(function(e){if(e.status===200)return e;var t=$.Deferred();return n[e.status]?t.reject(e):t.reject(e),t.promise()})}}),define("service/task-list",["require","exports","module","service/ajax"],function(e,t){var n=e("service/ajax");t.getTaskList=function(e){return n.jsonp("/api-prefix/task/list",{ts:(new Date).getTime()},e)}}),define("common/eventEmitter",["require","exports","module"],function(e,t){var n=$({}),r=Array.prototype.slice;t.fire=function(){n.trigger.apply(n,arguments)},t.on=function(e,t){n.on(e,function(){t.apply(null,r.call(arguments,1))})},t.un=function(){n.off.apply(n,arguments)},t.once=function(){n.one.apply(n,arguments)}}),define("dep/moduleHandler",["require","exports","module"],function(e,t){"use strict";var n=function(e){if(!e)return;r(e);var t=e.subModules;if(!t)return;for(var n=0;n<t.length;n++){var i=t[n];i&&$.isFunction(i.dispose)&&(t.splice(n,1),n--,i.dispose())}},r=function(e){var t=e.parentModule;if(!t)return;var n=t.subModules;for(var r=0;r<n.length;r++){var i=n[r];i===e&&(n.splice(r,1),r--)}};t.init=function(e,n){e=e||$("body");var r=e.size();if(r>1)$.each(e,function(){t.init($(this),n)});else if(r===1){var i=e.data("modulePath");i?t.load(i,e,n):t.init(e.children(),n)}},t.load=function(r,i,s){var o=i.data(),u=o.interceptorPath,a=function(e,r){if(e){$.isFunction(e)&&(e=new e),e.element=i,e.data=o;if($.isFunction(e.init)){var u=e.init(r);u&&u.done?u.done(function(n){t.init(i.children(),e)}):t.init(i.children(),e)}else t.init(i.children(),e);if(s){var a=s.subModules;a||(a=s.subModules=[]),a.push(e),e.parentModule=s}var f=e.dispose;$.isFunction(f)?e.dispose=function(){n(this),f.apply(this,arguments)}:e.dispose=function(){n(this)}}};e([r],function(t){u?e([u],function(e){if(e){e.element=i,e.data=o;if($.isFunction(e.init)){var n=e.init();n&&n.done?n.done(function(e){a(t,e)}):a(t,n)}else a(t)}}):a(t)})}}),define("task-list/sub-module-1",["require","exports","module","common/eventEmitter","dep/moduleHandler"],function(e,t){"use strict";var n=e("common/eventEmitter");t.init=function(n){var r=this.element,i=this.data;setTimeout(function(){r.html(Simplite.render("task-list-sub-module-1",{ip:i.ip,list:[{date:"2015-10-10",natureFlow:100,scoreCost:222,tgFlow:30},{date:"2015-10-11",natureFlow:381,scoreCost:334,tgFlow:41},{date:"2015-10-12",natureFlow:230,scoreCost:456,tgFlow:23}]})),e("dep/moduleHandler").init(r.children(),t)},1e3);return;var s},t.dispose=function(){console.log("dispose task-list/sub-module-1")}}),define("task-list/sub-module-2",["require","exports","module","common/eventEmitter"],function(e,t){"use strict";var n=e("common/eventEmitter");t.init=function(){var e=this.element,t=this.data;e.html(Simplite.render("task-list-sub-module-2","哈哈测试传递的参数")),e.on("click","div",function(){n.fire("sub2-clicked",{id:23})})},t.dispose=function(){console.log("dispose task-list/sub-module-2")}}),define("service/common/base-service",["require","exports","module","service/ajax"],function(e,t){var n=e("service/ajax");t.getData=function(e,t){return n.post("/api-prefix/common/base",e,t)}}),define("task-list/interceptor/base-data",["require","exports","module","service/common/base-service"],function(e,t){var n=e("service/common/base-service");t.init=function(){return n.getData().pipe(function(e){if(e.status===200)return e.data})}}),define("task-list/instance-demo",["require","exports","module"],function(e,t){"use strict";var n=function(){};return n.prototype.init=function(){var e=this;console.log(this.element),this.element.on("click","button",function(){e.dispose()})},n.prototype.dispose=function(){console.log("销毁了instance-demo",this.data.type),this.element.remove()},n}),Simplite.compiles["task-list-sub-module-1"]=function(e){return function(e){"use strict";var t=this,n="<div> ip："+t.defaultAttr(e.ip.replace(/\n/g,"<br>"))+'</div><table class="table"><thead><tr><th class="width-126">日期</th><th>浏览量</th><th>消耗学分</th><th>推广增量</th></tr></thead><tbody>',r;n+="";for(var i=0,s=e.list.length;i<s;i++)r=e.list[i],n+="<tr><td>"+t.defaultAttr(r.date)+"</td><td>"+t.defaultAttr(r.natureFlow+r.tgFlow)+"</td><td>"+t.defaultAttr(r.scoreCost)+'</td><td class="text-highlight">'+t.defaultAttr(r.tgFlow)+"</td></tr>";return n+='</tbody></table><div data-module-path="task-list/sub-module-2"></div> ',n}.call(Simplite,e)},Simplite.compiles["task-list-sub-module-2"]=function(e){return function(e){"use strict";var t=this,n='<div><a href="http://www.baidu.com">这个是子模块2</a></div>';return n+=t.include("task-list-sub2-include",e),n+=" ",n}.call(Simplite,e)},Simplite.compiles["task-list-sub2-include"]=function(e){return function(e){"use strict";var t=this,n="<p> 通过include传递参数"+t.defaultAttr(e)+"</p> ";return n}.call(Simplite,e)},define("task-list/main",["require","exports","module","service/task-list","./sub-module-1","./sub-module-2","./interceptor/base-data","./instance-demo","common/eventEmitter"],function(e,t){"use strict";var n=e("service/task-list");e("./sub-module-1"),e("./sub-module-2"),e("./interceptor/base-data"),e("./instance-demo");var r=e("common/eventEmitter"),i;t.init=function(e){console.log("模块能获取对应的interceptor的返回值：",e),i=this.element;var s=this.data;return i.on("click",".main",function(){console.log("module main clicked"),t.dispose()}),r.on("sub2-clicked",function(e){alert(e.id)}),i.find("div").data("ip",e.ip),n.getTaskList({holder:i}).done(function(e){console.log("这个是获取到的taskList数据，",e)})},t.dispose=function(){console.log("dispose task-list/main")}});